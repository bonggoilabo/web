(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{1727:function(e,t,a){"use strict";var o=a(1),r=a(49),n=function(e){return o.createElement("svg",e,o.createElement("defs",null,o.createElement("path",{id:"search_24px-a",d:"M16.864 16.134l4.497 4.471a.5.5 0 0 1-.705.71l-4.497-4.472a8.5 8.5 0 1 1 .706-.708zM10.5 18a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15z"})),o.createElement("use",{xlinkHref:"#search_24px-a"}))};n.defaultProps={xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"};var s=o.memo((function(e){return o.createElement(r.a,e,o.createElement(n,{width:"1em",height:"1em"}))}));s.displayName="WebMenuSearchIcon",t.a=s},3592:function(e,t){},3593:function(e,t){},4135:function(e,t,a){"use strict";a.r(t),a.d(t,"PointsMaxPopup",(function(){return S}));var o=a(3),r=a(1),n=a(26),s=a(404),i=a(30),l=a(8),m=a(1727),c=a(49),p=function(e){return r.createElement("svg",e,r.createElement("path",{d:"M12 23.5C5.649 23.5.5 18.351.5 12S5.649.5 12 .5 23.5 5.649 23.5 12 18.351 23.5 12 23.5zm4.727-17.135l-7.047 8.58-1.933-2.174A1 1 0 0 0 6.253 14.1l2.71 3.048a1 1 0 0 0 1.52-.03l7.79-9.483a1 1 0 0 0-1.546-1.27z"}))};p.defaultProps={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};var d=r.memo((function(e){return r.createElement(c.a,e,r.createElement(p,{width:"1em",height:"1em"}))}));d.displayName="RoomFilterGenericFilledIcon";var u=d,g=a(19),P=a(32),f=a(676),h=function(e,t){var a,o=(a=document.getElementById("requestVerificationToken"))?a.getAttribute("value"):"";P.a.sendJson("POST","/api/cronos/pointsmax/savepointsmax",{programID:e,requestValidationToken:o},12e4,{RequestVerificationToken:o}).then((function(){t&&t()})).catch((function(){window.location.reload()}))},v=function(e){var t=f.a.getAntiforgeryToken();return P.a.sendJson("POST","/api/cronos/loyaltyexternal/insertmembership",{token:t,MembershipId:e.membershipId,IsDefault:e.isDefault,ProgramId:e.programId})},x=function(e){var t=f.a.getAntiforgeryToken();return P.a.sendJson("POST","/api/cronos/loyaltyexternal/updatemembership",{token:t,MembershipId:e.membershipId,IsDefault:e.isDefault,ProgramId:e.programId})},M=function(){return P.a.getJson("/api/cronos/pointsmax/getmemberprograms",null,{RequestVerificationToken:f.a.getAntiforgeryToken()})},b=function(e,t){var a=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),o=new RegExp("[\\?&]"+a+"=([^&#]*)").exec(t);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},I=function(){b("pointsmax",window.location)&&!b("PointsMaxSecondLand",window.location)?window.location.search+=0===window.location.search.length?"?PointsMaxSecondLand=true":"&PointsMaxSecondLand=true":window.location.reload()},w=function(e,t){h(e,t?function(){}:I)},E=a(25),C=(a(3592),function(e){function t(t){var a=e.call(this,t)||this;return a.componentDidMount=function(){a.loadMyCurrentlyLinkedPrograms()},a.loadMyCurrentlyLinkedPrograms=function(){return M().then((function(e){void 0===e.Success?a.setState({allActivePrograms:e}):a.setState({allActivePrograms:null})}),(function(){a.setState({allActivePrograms:null})}))},a.handlePointsMaxProgramSelection=function(e){var t,o,r;if(a.stopPropagation(e),e&&e.currentTarget.getAttribute("data-pointsmax-program-id")){var n=a.state.displayPrograms.find((function(t){return t.programId===Number(e.currentTarget.getAttribute("data-pointsmax-program-id"))}));if(n){var s=null!==(r=null===(o=null===(t=a.state.allActivePrograms)||void 0===t?void 0:t.find((function(e){return e.programId===n.programId})))||void 0===o?void 0:o.membershipId)&&void 0!==r?r:"";a.setState({membershipId:s,step:1}),a.props.onSelectProgram(n)}}},a.onKeySearch=function(e){a.stopPropagation(e),e.currentTarget.value?a.setState({displayPrograms:a.props.allActivePrograms.filter((function(t){return t.programName.toLocaleLowerCase().indexOf(e.currentTarget.value.toLocaleLowerCase())>-1||t.translatedProgramName.toLocaleLowerCase().indexOf(e.currentTarget.value.toLocaleLowerCase())>-1}))}):a.setState({displayPrograms:a.props.allActivePrograms})},a.stopPropagation=function(e){e&&e.preventDefault(),e&&e.stopPropagation()},a.onMemberIdChange=function(e){a.setState({membershipId:e.currentTarget.value,invalidMemberId:!a.validate(e.currentTarget.value)})},a.getTurnOff=function(){return a.props.originalProgram||a.props.selectedProgram?r.createElement("div",{className:"PointsmaxMenu__Off"},r.createElement("a",{id:"pointsmax-off-panel",className:"PointsmaxMenu__OffText","data-element-name":"points-max-popup-turn-off-button",onClick:a.turnOff},r.createElement(l.A,{textSize:"S"},a.props.cms.turnOff))):null},a.closeModal=function(e){a.props.toggleModal(!1,a.props.isBlockPageReload,e)},a.turnOff=function(e){a.stopPropagation(e),a.props.originalProgram&&w(0,a.props.isBlockPageReload),a.closeModal(null)},a.gotoPreviousStep=function(e){a.stopPropagation(e),a.setState({step:0,displayPrograms:a.props.allActivePrograms})},a.onEnterMemberLaterClick=function(e){a.stopPropagation(e),a.processPointsMaxChange()},a.processPointsMaxChange=function(){var e,t;(null===(e=a.props.originalProgram)||void 0===e?void 0:e.programId)!==(null===(t=a.props.selectedProgram)||void 0===t?void 0:t.programId)&&w(a.props.selectedProgram.programId,a.props.isBlockPageReload),a.closeModal(a.props.selectedProgram)},a.insertMember=function(e){return v(e).then(a.processPointsMaxChange,a.processPointsMaxChange)},a.updateMember=function(e){return x(e).then(a.processPointsMaxChange,a.processPointsMaxChange)},a.validate=function(e){return!(!e||!e.match(a.props.selectedProgram.regex))},a.saveMemberId=function(e){var t;if(a.stopPropagation(e),a.validate(a.state.membershipId)){var o={programId:a.props.selectedProgram.programId,membershipId:a.state.membershipId,isDefault:!0};(null===(t=a.state.allActivePrograms)||void 0===t?void 0:t.find((function(e){return e.programId===a.props.selectedProgram.programId})))?a.updateMember(o):a.insertMember(o)}else a.setState({invalidMemberId:!0})},a.getPrograms=function(){var e=a.props.selectedProgram||a.props.originalProgram,t=(null==e?void 0:e.programId)>0?Object(o.g)([e],a.state.displayPrograms):a.state.displayPrograms;return t?t.map((function(t,o){if(!(o>0&&t.programId===(null==e?void 0:e.programId))){var n=e&&e.programId===t.programId?"selected":null,s=n?r.createElement(l.A,{className:"PointsmaxMenu__SelectedIcon"},r.createElement(u,{size:"M",color:"primary"})):null,i=o||t.programId!==(null==e?void 0:e.programId)?null:r.createElement(l.A,{textSize:"S",className:"PointsmaxMenu__NameEdit"},a.props.cms.edit);return r.createElement("li",{className:Object(E.a)(Object(E.c)("PointsmaxMenu__Item",n),n?"active":null),key:o,"data-element-name":"points-max-popup-program","data-pointsmax-program-id":t.programId,onClick:a.handlePointsMaxProgramSelection,"data-selenium":"pointsmax-program-item"},r.createElement("figure",{className:"PointsmaxMenu__Logo"},r.createElement("img",{src:t.imageUrl,alt:t.translatedProgramName,"data-id":"pointsmax-partner-program-icon","data-selenium":"pointsmax-program-image-"+t.programId,"data-img":t.bigImageUrl}),s),r.createElement(l.w,{className:"PointsmaxMenu__Name",textSize:"S","data-id":"pointsmax-partner-program-text","data-selenium":"pointsmax-program-text-"+t.programId},t.translatedProgramName,i))}})):null},a.state={isModalOpen:t.isModalOpen,step:0,displayPrograms:t.allActivePrograms,allActivePrograms:null,membershipId:null,invalidMemberId:!1},a}return Object(o.c)(t,e),t.getDerivedStateFromProps=function(e,t){return{state:t,step:e.isModalOpen!==t.isModalOpen?0:t.step,isModalOpen:e.isModalOpen}},t.prototype.render=function(){var e;return this.state.step?r.createElement("div",{className:"modal-content PointsmaxPopupContent","data-element-name":"points-max-popup"},r.createElement(l.p,{variant:"h3"},this.props.cms.linkYourAccount),r.createElement("div",{className:"PointsmaxMenu__RewardLabel"},this.props.cms.rewardProgram),r.createElement("div",{className:"PointsmaxMenu__RewardNameContainer"},r.createElement("img",{src:this.props.selectedProgram.imageUrl,alt:this.props.selectedProgram.translatedProgramName,"data-img":this.props.selectedProgram.bigImageUrl}),r.createElement(l.A,{className:"PointsmaxMenu__RewardName"},this.props.selectedProgram.translatedProgramName),r.createElement("a",{onClick:this.gotoPreviousStep},r.createElement(l.A,{textSize:"S"},this.props.cms.change))),r.createElement("div",{className:"PointsmaxMenu__RewardLabel"},this.props.cms.membershipNumber),r.createElement(l.q,{className:"PointsmaxMenu__RewardMemberId",type:"text",placeholder:(null===(e=this.props.selectedProgram)||void 0===e?void 0:e.memberIdPattern)?g.StringFormatter.format(this.props.cms.formatSample,this.props.selectedProgram.memberIdPattern):"",value:this.state.membershipId,onChange:this.onMemberIdChange,onClick:this.stopPropagation,color:this.state.invalidMemberId?"error":void 0}),r.createElement("div",{className:"PointsmaxMenu__RewardButtonContainer"},r.createElement(l.e,{className:Object(E.c)("PointsmaxMenu__RewardButton","later"),variant:"flat",onClick:this.onEnterMemberLaterClick,"data-selenium":"points-max-popup-enter-later"},this.props.cms.cancel),r.createElement(l.e,{className:Object(E.c)("PointsmaxMenu__RewardButton","save"),variant:"solid","data-element-name":"points-max-popup-save-button",onClick:this.saveMemberId},this.props.cms.save))):r.createElement("div",{id:"pointsmax-popup-component",className:"modal-content PointsmaxPopupContent","data-element-name":"points-max-popup",onClick:this.stopPropagation,"data-selenium":"pointsmax-popup-component"},r.createElement(l.p,{variant:"h3"},this.props.cms.title),r.createElement(l.w,null,this.props.cms.subTitle),r.createElement("div",{className:"PointsmaxMenu"},r.createElement(l.q,{className:"PointsmaxMenu__SearchBox",type:"text",placeholder:this.props.cms.searchPlaceHolder,icon:r.createElement(m.a,{color:300}),onChange:this.onKeySearch}),r.createElement("div",{className:"PointsmaxMenu__Container"},this.getTurnOff(),r.createElement("ul",{className:"PointsmaxMenu__Items"},this.getPrograms()))))},t}(r.Component)),O=(a(3593),{content:{overflow:"hidden",left:"50%",top:"50%",msTransform:"translate(-50%, -50%)",transform:"translate(-50%, -50%)",right:"auto",bottom:"auto"},overlay:{background:"rgba(0, 0, 0, 0.80)"}}),S=function(e){function t(t){var a=e.call(this,t)||this;return a.toggleModal=function(e,t,o){a.setState({isBlockPageReload:t,isModalOpen:e,selectedProgram:null,originalProgram:o})},a.openPointsMaxPopup=function(e){a.toggleModal(!0,e,a.state.originalProgram)},a.hidePointsMaxPopup=function(e){e&&e.stopPropagation(),e&&e.preventDefault(),a.state.selectedProgram&&w(a.state.selectedProgram.programId,a.state.isBlockPageReload),a.toggleModal(!1,!1,a.state.selectedProgram||a.state.originalProgram)},a.getModalCloseButton=function(e){return r.createElement("div",{className:"close-area","data-element-name":"points-max-popup-close-button",onClick:e},r.createElement("i",{id:"pointsmax-close-icon",className:"ficon ficon-16 ficon-x-icon close pointsmax-close-modal-icon","aria-label":"Close","data-selenium":"pointsmax-close-icon",onClick:e}))},a.onSelectProgram=function(e){a.setState({selectedProgram:e})},a.buildPointsMaxPopupContentProps=function(){return Object(o.a)(Object(o.a)({},a.state),{onSelectProgram:a.onSelectProgram,toggleModal:a.toggleModal})},a.state=Object(o.a)(Object(o.a)(Object(o.a)({},t),Object(n.p)()),{isModalOpen:!1,isBlockPageReload:!1,selectedProgram:null,originalProgram:t.selectedPrograms}),Object(i.b)(i.a.OPEN_POINTSMAX_POPUP,a.openPointsMaxPopup),Object(i.b)(i.a.HIDE_POINTSMAX_POPUP,a.hidePointsMaxPopup),a}return Object(o.c)(t,e),t.prototype.render=function(){return r.createElement(s.default,{isOpen:this.state.isModalOpen,shouldCloseOnOverlayClick:!0,style:O,noCloseButton:!1,bodyOpenClassName:"ReactPointsMaxModal__Body--open",onRequestClose:this.hidePointsMaxPopup,closeButton:this.getModalCloseButton(this.hidePointsMaxPopup)},r.createElement(C,Object(o.a)({},this.buildPointsMaxPopupContentProps())))},t}(r.Component);t.default=S}}]);